<UserControl x:Class="HardHorn.Views.ArchiveVersionView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:HardHorn.Views"
        xmlns:cal="http://www.caliburnproject.org"
        xmlns:util="clr-namespace:HardHorn.Utilities"
        xmlns:av="clr-namespace:HardHorn.Archiving;assembly=LibHardHorn"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:ana="clr-namespace:HardHorn.Analysis;assembly=LibHardHorn"
        xmlns:vm="clr-namespace:HardHorn.ViewModels"
        xmlns:oxy="http://oxyplot.org/wpf"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600">
    <TabControl SelectedIndex="{Binding TabSelectedIndex}">
        <TabItem Header="Tabel- og datavisning">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="300" />
                    <ColumnDefinition Width="5" />
                    <ColumnDefinition MinWidth="250" Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"></RowDefinition>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <StackPanel Grid.Column="2">
                    <StackPanel Orientation="Horizontal">
                        <Button Margin="0 5 0 5" cal:Message.Attach="OpenSelectedTableViewModel()">
                            <Button.Content>
                                <TextBlock>
                                    <TextBlock.Text>
                                        <MultiBinding StringFormat="{}Åbn {0}.xml">
                                            <Binding Path="SelectedTableViewModel.Table.Folder" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </Button.Content>
                        </Button>
                        <TextBlock Margin="5 0 0 0"  FontWeight="Black" Text="{Binding SelectedTableViewModel.Table.Name}" VerticalAlignment="Center" />
                        <TextBlock Margin="5 0 0 0" VerticalAlignment="Center">
                            <TextBlock.Text>
                                <MultiBinding StringFormat="{}({0} rækker)">
                                    <Binding Path="SelectedTableViewModel.Table.Rows" />
                                </MultiBinding>
                            </TextBlock.Text>
                        </TextBlock>
                    </StackPanel>
                    <TextBox Height="35" TextWrapping="Wrap" Text="{Binding SelectedTableViewModel.Description, UpdateSourceTrigger=PropertyChanged}" />
                    <WrapPanel Grid.Row="2" Grid.Column="2" Margin="5" Grid.ColumnSpan="2">
                        <CheckBox IsChecked="{Binding ShowErrorReports}" Margin="0 0 10 0">Vis fejl</CheckBox>
                        <CheckBox IsChecked="{Binding ShowSuggestionReports}" Margin="0 0 10 0">Vis forslag</CheckBox>
                        <CheckBox IsChecked="{Binding ShowEmptyReports}" Margin="0 0 10 0">Vis resten</CheckBox>
                    </WrapPanel>
                    <StackPanel.Style>
                        <Style>
                            <Setter Property="StackPanel.Visibility" Value="Visible"></Setter>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding SelectedTableViewModel}" Value="{x:Null}">
                                    <Setter Property="StackPanel.Visibility" Value="Collapsed"></Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>
                </StackPanel>

                <DockPanel Grid.RowSpan="3">
                    <ComboBox SelectedIndex="0" DockPanel.Dock="Top" SelectedItem="{Binding InteractiveFilterDataType, Mode=OneWayToSource}">
                        <ComboBox.Resources>
                            <ObjectDataProvider x:Key="DataTypeEnumValues" MethodName="GetValues" ObjectType="{x:Type sys:Enum}">
                                <ObjectDataProvider.MethodParameters>
                                    <x:Type TypeName="av:DataType"></x:Type>
                                </ObjectDataProvider.MethodParameters>
                            </ObjectDataProvider>
                        </ComboBox.Resources>
                        <ComboBox.ItemsSource>
                            <CompositeCollection>
                                <ComboBoxItem>Ingen datatype filtrering</ComboBoxItem>
                                <CollectionContainer Collection="{Binding Source={StaticResource DataTypeEnumValues}}"></CollectionContainer>
                            </CompositeCollection>
                        </ComboBox.ItemsSource>
                    </ComboBox>
                    <Grid DockPanel.Dock="Top" >
                        <TextBox Text="{Binding TableColumnNameFilter, UpdateSourceTrigger=PropertyChanged}" />
                        <Label Foreground="Gray" IsHitTestVisible="False">Tabel eller kolonne
                            <Label.Style>
                                <Style>
                                    <Setter Property="Label.Visibility" Value="Hidden" ></Setter>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding TableColumnNameFilter}" Value="">
                                            <Setter Property="Label.Visibility" Value="Visible" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding TableColumnNameFilter}" Value="{x:Null}">
                                            <Setter Property="Label.Visibility" Value="Visible" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Label.Style>
                        </Label>
                    </Grid>
                    <Grid DockPanel.Dock="Bottom">
                        <ProgressBar Height="20" Value="{Binding TestProgress, Mode=OneWay}" />
                        <Canvas VerticalAlignment="Center" Height="16">
                            <TextBlock FontWeight="Bold" Width="300" TextAlignment="Center" Canvas.Top="0" Canvas.Left="0" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="AnalysisTotalDoneRows" />
                                        <Binding Path="AnalysisTotalRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="300" TextAlignment="Center" Canvas.Top="2" Canvas.Left="0" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="AnalysisTotalDoneRows" />
                                        <Binding Path="AnalysisTotalRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="300" TextAlignment="Center" Canvas.Top="2" Canvas.Left="2" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="AnalysisTotalDoneRows" />
                                        <Binding Path="AnalysisTotalRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="300" TextAlignment="Center" Canvas.Top="0" Canvas.Left="2" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="AnalysisTotalDoneRows" />
                                        <Binding Path="AnalysisTotalRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="300" TextAlignment="Center" Canvas.Top="1" Canvas.Left="1" Foreground="White">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="AnalysisTotalDoneRows" />
                                        <Binding Path="AnalysisTotalRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                        </Canvas>
                    </Grid>

                    <Grid DockPanel.Dock="Bottom">
                        <ProgressBar Height="20" Value="{Binding TableTestProgress, Mode=OneWay}" />
                        <Canvas VerticalAlignment="Center" Height="16">
                            <TextBlock FontWeight="Bold" Width="300" TextAlignment="Center" Canvas.Top="0" Canvas.Left="0" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="AnalysisTableDoneRows" />
                                        <Binding Path="AnalysisTableRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="300" TextAlignment="Center" Canvas.Top="2" Canvas.Left="0" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="AnalysisTableDoneRows" />
                                        <Binding Path="AnalysisTableRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="300" TextAlignment="Center" Canvas.Top="2" Canvas.Left="2" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="AnalysisTableDoneRows" />
                                        <Binding Path="AnalysisTableRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="300" TextAlignment="Center" Canvas.Top="0" Canvas.Left="2" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="AnalysisTableDoneRows" />
                                        <Binding Path="AnalysisTableRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="300" TextAlignment="Center" Canvas.Top="1" Canvas.Left="1" Foreground="White">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="AnalysisTableDoneRows" />
                                        <Binding Path="AnalysisTableRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                        </Canvas>
                    </Grid>
                    <ListBox ItemsSource="{Binding InteractiveTablesView}" cal:Message.Attach="[Event SelectionChanged] = [Action UpdateSelection($eventArgs)]" SelectionMode="Extended"  SelectedItem="{Binding SelectedTableViewModel, Mode=OneWayToSource}" ItemContainerStyle="{StaticResource AnalysisTableListContainerStyle}"/>
                </DockPanel>

                <GridSplitter Grid.Row="1" Grid.Column="1" Width="5" HorizontalAlignment="Stretch" Grid.RowSpan="2"></GridSplitter>
                <ListView SelectionMode="Single" x:Name="ColumnListView" Grid.Row="1" Grid.Column="2" SelectedItem="{Binding SelectedTableViewModel.SelectedColumnViewModel}" ItemsSource="{Binding ColumnsView}" util:GridViewSort.AutoSort="True">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Id" Width="50" DisplayMemberBinding="{Binding Column.ColumnId}" util:GridViewSort.PropertyName="Column.ColumnIdNumber"></GridViewColumn>
                            <GridViewColumn Header="Navn" Width="150" DisplayMemberBinding="{Binding Column.Name}" util:GridViewSort.PropertyName="Column.Name"></GridViewColumn>
                            <GridViewColumn Header="Fejl" Width="80" util:GridViewSort.PropertyName="Analysis.ErrorCount">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding ErrorCount}">
                                            <TextBlock.Style>
                                                <Style>
                                                    <Setter Property="TextBlock.Foreground" Value="Red"></Setter>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding ErrorCount}" Value="0">
                                                            <Setter Property="TextBlock.Foreground" Value="{StaticResource {x:Static SystemColors.ControlTextBrushKey}}"></Setter>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Datatype" Width="170" util:GridViewSort.PropertyName="ParameterizedDataType">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock>
                                            <TextBlock.Text>
                                                <MultiBinding StringFormat="{}{0} {1}">
                                                    <Binding Path="DataType" Converter="{StaticResource DataTypeToStringConverter}"/>
                                                    <Binding Path="ParameterViewModel.Representation"/>
                                                </MultiBinding>
                                            </TextBlock.Text>
                                            <TextBlock.Style>
                                                <Style>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding DataType}" Value="{x:Static av:DataType.UNDEFINED}">
                                                            <Setter Property="TextBlock.Foreground" Value="Red"></Setter>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Datatypeforslag" Width="170" util:GridViewSort.PropertyName="Analysis.SuggestedType">
                                <GridViewColumn.DisplayMemberBinding>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="Analysis.SuggestedType.DataType" Converter="{StaticResource DataTypeToStringConverter}"/>
                                        <Binding Path="Analysis.SuggestedType" Converter="{StaticResource ParameterizedDataTypeToParameterStringConverter}"/>
                                    </MultiBinding>
                                </GridViewColumn.DisplayMemberBinding>
                            </GridViewColumn>
                            <GridViewColumn Header="Minimumslængde" Width="70" DisplayMemberBinding="{Binding MinLength}"  util:GridViewSort.PropertyName="MinLength"></GridViewColumn>
                            <GridViewColumn Header="Maksimumslængde" Width="70" DisplayMemberBinding="{Binding MaxLength}" util:GridViewSort.PropertyName="MaxLength"></GridViewColumn>
                        </GridView>
                    </ListView.View>
                </ListView>
                <TabControl Grid.Row="2" Grid.Column="2">
                    <TabControl.Style>
                        <Style TargetType="TabControl">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding SelectedTableViewModel}" Value="{x:Null}">
                                    <Setter Property="Visibility" Value="Collapsed"></Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TabControl.Style>
                    <TabItem Header="Postvisning">
                        <DockPanel>
                            <StackPanel Margin="5" Orientation="Horizontal" DockPanel.Dock="Top">
                                <TextBlock VerticalAlignment="Center">Viser</TextBlock>
                                <TextBox Margin="5 0 0 0" Text="{Binding SelectedTableViewModel.BrowseCount}" Width="35">
                                    <TextBox.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedTableViewModel}" Value="{x:Null}">
                                                    <Setter Property="TextBox.IsEnabled" Value="False"></Setter>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding SelectedTableViewModel.BrowseReady}" Value="False">
                                                    <Setter Property="TextBox.IsEnabled" Value="False"></Setter>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                                <TextBlock Margin="5 0 0 0" VerticalAlignment="Center">rækker fra række</TextBlock>
                                <TextBox Margin="5 0 0 0" Text="{Binding SelectedTableViewModel.BrowseOffset}" Width="70">
                                    <TextBox.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedTableViewModel}" Value="{x:Null}">
                                                    <Setter Property="TextBox.IsEnabled" Value="False"></Setter>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding SelectedTableViewModel.BrowseReady}" Value="False">
                                                    <Setter Property="TextBox.IsEnabled" Value="False"></Setter>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                                <Button Margin="5 0 0 0" Width="100" cal:Message.Attach="BrowseUpdate">
                                    <Button.Content>
                                        <TextBlock>
                                            <TextBlock.Style>
                                                <Style>
                                                    <Setter Property="TextBlock.Text" Value="Opdater"></Setter>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding SelectedTableViewModel.BrowseReady}" Value="false">
                                                            <Setter Property="TextBlock.Text">
                                                                <Setter.Value>
                                                                    <MultiBinding StringFormat="{}Opdaterer ({0}%)">
                                                                        <Binding Path="SelectedTableViewModel.BrowseReadProgress" />
                                                                    </MultiBinding>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Button.Content>
                                    <Button.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedTableViewModel}" Value="{x:Null}">
                                                    <Setter Property="Button.IsEnabled" Value="False"></Setter>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding SelectedTableViewModel.BrowseReady}" Value="False">
                                                    <Setter Property="Button.IsEnabled" Value="False"></Setter>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <Button Margin="5 0 0 0" cal:Message.Attach="BrowsePrevious">
                                    <Button.Content>
                                        <TextBlock>
                                            <TextBlock.Style>
                                                <Style>
                                                    <Setter Property="TextBlock.Text">
                                                        <Setter.Value>
                                                            <MultiBinding StringFormat="{}Forrige {0}">
                                                                <Binding Path="SelectedTableViewModel.BrowseCount"></Binding>
                                                            </MultiBinding>
                                                        </Setter.Value>
                                                    </Setter>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding SelectedTableViewModel}" Value="{x:Null}">
                                                            <Setter Property="TextBlock.Text" Value="Forrige"></Setter>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Button.Content>
                                    <Button.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedTableViewModel}" Value="{x:Null}">
                                                    <Setter Property="Button.IsEnabled" Value="False"></Setter>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                                <Button Margin="5 0 0 0" cal:Message.Attach="BrowseNext">
                                    <Button.Content>
                                        <TextBlock>
                                            <TextBlock.Style>
                                                <Style>
                                                    <Setter Property="TextBlock.Text">
                                                        <Setter.Value>
                                                            <MultiBinding StringFormat="{}Næste {0}">
                                                                <Binding Path="SelectedTableViewModel.BrowseCount"></Binding>
                                                            </MultiBinding>
                                                        </Setter.Value>
                                                    </Setter>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding SelectedTableViewModel}" Value="{x:Null}">
                                                            <Setter Property="TextBlock.Text" Value="Næste"></Setter>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Button.Content>
                                    <Button.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedTableViewModel}" Value="{x:Null}">
                                                    <Setter Property="Button.IsEnabled" Value="False"></Setter>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                </Button>
                            </StackPanel>
                            <DataGrid ItemsSource="{Binding SelectedTableViewModel.RowDataTable}" CellStyle="{StaticResource DataGridCellStyle}" IsReadOnly="True" SelectionUnit="Cell" />
                        </DockPanel>
                    </TabItem>
                    <TabItem Header="Nøgler">
                        <StackPanel>
                            <GroupBox>
                                <GroupBox.Header>
                                    <TextBlock FontWeight="Bold" Text="{Binding SelectedTableViewModel.Table.PrimaryKey.Name}" />
                                </GroupBox.Header>
                                <ItemsControl ItemsSource="{Binding SelectedTableViewModel.Table.PrimaryKey.Columns}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding}"></TextBlock>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </GroupBox>
                            <ItemsControl ItemsSource="{Binding SelectedTableViewModel.ForeignKeyViewModels}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <GroupBox>
                                            <GroupBox.Header>
                                                <TextBlock FontWeight="Bold" Text="{Binding Name}" />
                                            </GroupBox.Header>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <ItemsControl ItemsSource="{Binding ReferenceViewModels}">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding Reference.Column.Name}"></TextBlock>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                                <ItemsControl Grid.Column="1" ItemsSource="{Binding ReferenceViewModels}">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Button Margin="0,0,0,2" Style="{StaticResource HyperlinkButtonStyle}" cal:Message.Attach="[Event Click] = [Action GoToReferencedColumn($dataContext)]">
                                                                <TextBlock Margin="0,0,0,-2">
                                                                    <TextBlock.Text>
                                                                        <MultiBinding StringFormat="{}{0}.{1} &lt;{2}&gt;">
                                                                            <Binding Path="Reference.ReferencedColumn.Table.Name"></Binding>
                                                                            <Binding Path="Reference.ReferencedColumn.Name"></Binding>
                                                                            <Binding Path="Reference.ReferencedColumn.ColumnId"></Binding>
                                                                        </MultiBinding>
                                                                    </TextBlock.Text>
                                                                </TextBlock>
                                                            </Button>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </Grid>
                                        </GroupBox>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </TabItem>
                    <TabItem Header="Fejlvisning">
                        <TabItem.Style>
                            <Style TargetType="TabItem">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedTableViewModel}" Value="{x:Null}">
                                        <Setter Property="Visibility" Value="Collapsed"></Setter>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding SelectedTableViewModel.SelectedColumnViewModel}" Value="{x:Null}">
                                        <Setter Property="Visibility" Value="Collapsed"></Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TabItem.Style>
                        <TabControl SelectedItem="{Binding Path=SelectedItem.SelectedTest, ElementName=ColumnListView}" ItemsSource="{Binding Path=SelectedItem.Tests, ElementName=ColumnListView}">
                            <TabControl.ItemTemplate>
                                <DataTemplate DataType="{x:Type ana:Test}">
                                    <TextBlock>
                                        <TextBlock.Text>
                                            <MultiBinding StringFormat="{}{0} ({1})">
                                                <Binding Path="Type" />
                                                <Binding Path="ErrorCount" />
                                            </MultiBinding>
                                        </TextBlock.Text>
                                    </TextBlock>
                                </DataTemplate>
                            </TabControl.ItemTemplate>
                            <TabControl.ContentTemplate>
                                <DataTemplate>
                                    <ListView ItemsSource="{Binding ErrorPosts}">
                                        <ListView.View>
                                            <GridView>
                                                <GridViewColumn Header="Line" Width="80" DisplayMemberBinding="{Binding Line}"></GridViewColumn>
                                                <GridViewColumn Header="Position" Width="80" DisplayMemberBinding="{Binding Position}"></GridViewColumn>
                                                <GridViewColumn Header="Er null" Width="50" DisplayMemberBinding="{Binding IsNull}"></GridViewColumn>
                                                <GridViewColumn Header="Længde" Width="50" DisplayMemberBinding="{Binding Data.Length}"></GridViewColumn>
                                                <GridViewColumn Header="Data" Width="700">
                                                    <GridViewColumn.CellTemplate>
                                                        <DataTemplate>
                                                            <TextBox x:Name="DataTextBox" BorderThickness="0" Text="{Binding Data}">
                                                                <TextBox.Style>
                                                                    <Style>
                                                                        <Setter Property="TextBox.Background" Value="{StaticResource {x:Static SystemColors.WindowBrushKey}}"></Setter>
                                                                        <Setter Property="TextBox.Foreground" Value="Black"></Setter>
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type ListViewItem}}, Path=IsSelected}" Value="True">
                                                                                <Setter Property="TextBox.Background" Value="{StaticResource {x:Static SystemColors.HighlightBrushKey}}"></Setter>
                                                                                <Setter Property="TextBox.Foreground" Value="{StaticResource {x:Static SystemColors.HighlightTextBrushKey}}"></Setter>
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </TextBox.Style>
                                                            </TextBox>
                                                        </DataTemplate>
                                                    </GridViewColumn.CellTemplate>
                                                </GridViewColumn>
                                            </GridView>
                                        </ListView.View>
                                    </ListView>
                                </DataTemplate>
                            </TabControl.ContentTemplate>
                        </TabControl>
                    </TabItem>
                    <TabItem Header="Modificér">
                        <TabItem.Style>
                            <Style TargetType="TabItem">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding SelectedTableViewModel}" Value="{x:Null}">
                                        <Setter Property="Visibility" Value="Collapsed"></Setter>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding SelectedTableViewModel.SelectedColumnViewModel}" Value="{x:Null}">
                                        <Setter Property="Visibility" Value="Collapsed"></Setter>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TabItem.Style>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"></ColumnDefinition>
                                <ColumnDefinition MinWidth="100" Width="Auto"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Label>Beskrivelse</Label>
                            <TextBox Grid.Column="1" MaxLines="4" Height="35" TextWrapping="Wrap" Width="200" Text="{Binding SelectedTableViewModel.SelectedColumnViewModel.Description, UpdateSourceTrigger=PropertyChanged}" />
                            <Label Grid.Row="1">Datatype</Label>
                            <ComboBox Grid.Row="1" Grid.Column="1" SelectedItem="{Binding SelectedTableViewModel.SelectedColumnViewModel.DataType}">
                                <ComboBox.Resources>
                                    <ObjectDataProvider x:Key="DataTypeEnumValues" MethodName="GetValues" ObjectType="{x:Type sys:Enum}">
                                        <ObjectDataProvider.MethodParameters>
                                            <x:Type TypeName="av:DataType"></x:Type>
                                        </ObjectDataProvider.MethodParameters>
                                    </ObjectDataProvider>
                                </ComboBox.Resources>
                                <ComboBox.ItemsSource>
                                    <CompositeCollection>
                                        <CollectionContainer Collection="{Binding Source={StaticResource DataTypeEnumValues}}"></CollectionContainer>
                                    </CompositeCollection>
                                </ComboBox.ItemsSource>
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Converter={StaticResource DataTypeToStringConverter}}" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            <Label Grid.Row="2">Parameter</Label>
                            <StackPanel Orientation="Horizontal" Grid.Row="2" Grid.Column="1">
                                <TextBox Text="{Binding SelectedTableViewModel.SelectedColumnViewModel.ParameterViewModel.Length, UpdateSourceTrigger=PropertyChanged}">
                                    <TextBox.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedTableViewModel.SelectedColumnViewModel.ParameterViewModel.HasLength}" Value="False">
                                                    <Setter Property="TextBox.Visibility" Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                                <TextBox Text="{Binding SelectedTableViewModel.SelectedColumnViewModel.ParameterViewModel.Precision, UpdateSourceTrigger=PropertyChanged}">
                                    <TextBox.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedTableViewModel.SelectedColumnViewModel.ParameterViewModel.HasPrecision}" Value="False">
                                                    <Setter Property="TextBox.Visibility" Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                                <TextBox Text="{Binding SelectedTableViewModel.SelectedColumnViewModel.ParameterViewModel.Scale, UpdateSourceTrigger=PropertyChanged}">
                                    <TextBox.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedTableViewModel.SelectedColumnViewModel.ParameterViewModel.HasScale}" Value="False">
                                                    <Setter Property="TextBox.Visibility" Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                            </StackPanel>
                            <Label Grid.Row="3">Kan være null</Label>
                            <CheckBox VerticalAlignment="Center" Grid.Row="3" Grid.Column="1" IsChecked="{Binding SelectedTableViewModel.SelectedColumnViewModel.Column.Nullable}"></CheckBox>
                            <Button Grid.Row="4" cal:Message.Attach="ApplySuggestion">Anvend datatypeforslag</Button>
                        </Grid>
                    </TabItem>
                </TabControl>
            </Grid>
        </TabItem>

        <TabItem Header="Metadata">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <Grid ScrollViewer.CanContentScroll="True">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <Label>Tidligere ID:</Label>
                    <Label Grid.Column="1" Content="{Binding ArchiveVersion.PreviousId}" />

                    <Label Grid.Row="1">Startdato:</Label>
                    <Label Grid.Row="1" Grid.Column="1" Content="{Binding ArchiveVersion.PeriodStart}" />

                    <Label Grid.Row="2">Slutdato:</Label>
                    <Label Grid.Row="2" Grid.Column="1" Content="{Binding ArchiveVersion.PeriodEnd}" />

                    <Label Grid.Row="3">Slutaflevering:</Label>
                    <CheckBox Grid.Row="3" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.PacketType, Mode=OneWay}" />

                    <Label Grid.Row="4">Arkivskabere:</Label>
                    <ItemsControl Grid.Row="4" Grid.Column="1" ItemsSource="{Binding ArchiveVersion.ArchiveCreators}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Label>Navn:</Label>
                                    <Label Grid.Column="1" Content="{Binding Name}" />

                                    <Label Grid.Row="1">Startdato:</Label>
                                    <Label Grid.Row="1" Grid.Column="1" Content="{Binding PeriodStart}" />

                                    <Label Grid.Row="2">Slutdato:</Label>
                                    <Label Grid.Row="2" Grid.Column="1" Content="{Binding PeriodEnd}" />
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <Label Grid.Row="5">Afsluttet arkivperiode:</Label>
                    <CheckBox Grid.Row="5" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.PeriodType, Mode=OneWay}" />

                    <Label Grid.Row="6">Systemnavn:</Label>
                    <Label Grid.Row="6" Grid.Column="1" Content="{Binding ArchiveVersion.SystemName}" />

                    <Label Grid.Row="7">Alternative systemnavne:</Label>
                    <ItemsControl Grid.Row="7" Grid.Column="1" ItemsSource="{Binding ArchiveVersion.AlternativeNames}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Label Content="{Binding}" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <Label Grid.Row="8">Systemformål:</Label>
                    <Label Grid.Row="8" Grid.Column="1" Content="{Binding ArchiveVersion.SystemPurpose}" />

                    <Label Grid.Row="9">Systemindhold:</Label>
                    <Label Grid.Row="9" Grid.Column="1" Content="{Binding ArchiveVersion.SystemContent}" />

                    <Label Grid.Row="10">Regionsnumre anvendt:</Label>
                    <CheckBox Grid.Row="10" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.RegionNumbersUsed, Mode=OneWay}" />

                    <Label Grid.Row="11">Kommunenumre anvendt:</Label>
                    <CheckBox Grid.Row="11" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.KommuneNumbersUsed, Mode=OneWay}" />

                    <Label Grid.Row="12">CPR-numre anvendt:</Label>
                    <CheckBox Grid.Row="12" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.CPRNumbersUsed, Mode=OneWay}" />

                    <Label Grid.Row="13">Matrikelnumre anvendt:</Label>
                    <CheckBox Grid.Row="13" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.MatrikelNumbersUsed, Mode=OneWay}" />

                    <Label Grid.Row="14">CVR-numre anvendt:</Label>
                    <CheckBox Grid.Row="14" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.CVRNumbersUsed, Mode=OneWay}" />

                    <Label Grid.Row="15">BBR-numre anvendt:</Label>
                    <CheckBox Grid.Row="15" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.BBRNumbersUsed, Mode=OneWay}" />
                    
                    <Label Grid.Row="16">WHO sygdomskoder anvendt:</Label>
                    <CheckBox Grid.Row="16" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.WHOCodesUsed, Mode=OneWay}" />

                    <Label Grid.Row="17">Datakilder:</Label>
                    <ItemsControl Grid.Row="17" Grid.Column="1" ItemsSource="{Binding ArchiveVersion.SourceNames}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Label Content="{Binding}" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <Label Grid.Row="18">Databrugere:</Label>
                    <ItemsControl Grid.Row="18" Grid.Column="1" ItemsSource="{Binding ArchiveVersion.UserNames}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Label Content="{Binding}" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <Label Grid.Row="19">Forgængersystemer:</Label>
                    <ItemsControl Grid.Row="19" Grid.Column="1" ItemsSource="{Binding ArchiveVersion.PredecessorNames}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Label Content="{Binding}" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <Label Grid.Row="20">FORM-version:</Label>
                    <Label Grid.Row="20" Grid.Column="1" Content="{Binding ArchiveVersion.FORMVersion}" />

                    <Label Grid.Row="21">FORM-klassificeringer:</Label>
                    <ItemsControl Grid.Row="21" Grid.Column="1" ItemsSource="{Binding ArchiveVersion.FORMClassifications}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Label>Klassificering:</Label>
                                    <Label Grid.Column="1" Content="{Binding Classification}" />

                                    <Label Grid.Row="1">Tekst:</Label>
                                    <Label Grid.Row="1" Grid.Column="1" Content="{Binding Text}" />
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                    
                    <Label Grid.Row="22">Digitale doukmenter indeholdt:</Label>
                    <CheckBox Grid.Row="22" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.ContainsDigitalDocuments, Mode=OneWay}" />

                    <Label Grid.Row="23">Søgemiddel til andre sager/dokumenter:</Label>
                    <CheckBox Grid.Row="23" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.SearchRelatedOtherRecords, Mode=OneWay}" />

                    <Label Grid.Row="24">Adresserede arkivvalier:</Label>
                    <ItemsControl Grid.Row="24" Grid.Column="1" ItemsSource="{Binding ArchiveVersion.RelatedRecordsNames}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Label Content="{Binding}" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                    <Label Grid.Row="25">Eksistens af sagsbegreb:</Label>
                    <CheckBox Grid.Row="25" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.SystemFileConcept, Mode=OneWay}" />

                    <Label Grid.Row="26">SOA arkitektur:</Label>
                    <CheckBox Grid.Row="26" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.MultipleDataCollection, Mode=OneWay}" />

                    <Label Grid.Row="27">Persondata:</Label>
                    <CheckBox Grid.Row="27" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.PersonalDataRestrictedInfo, Mode=OneWay}" />
                    
                    <Label Grid.Row="28">Fristforlængende oplysninger:</Label>
                    <CheckBox Grid.Row="28" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.OtherAccessTypeRestrictions, Mode=OneWay}" />

                    <Label Grid.Row="29">Godkendelsesarkiv:</Label>
                    <CheckBox Grid.Row="29" Grid.Column="1" Margin="5 0 0 0" VerticalAlignment="Center" Focusable="False" IsHitTestVisible="False" IsChecked="{Binding ArchiveVersion.ArchiveApproval, Mode=OneWay}" />
                </Grid>
            </ScrollViewer>
        </TabItem>
        
        <TabItem Header="Fejlvisning">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"></ColumnDefinition>
                    <ColumnDefinition></ColumnDefinition>
                </Grid.ColumnDefinitions>

                <ListView x:Name="ErrorViewModelList" ItemsSource="{Binding ErrorViewModels}">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Fejltype" DisplayMemberBinding="{Binding Header}"></GridViewColumn>
                            <GridViewColumn Header="Antal subjekter" DisplayMemberBinding="{Binding Subjects.Count}"></GridViewColumn>
                            <GridViewColumn Header="Samlet antal" DisplayMemberBinding="{Binding Count}"></GridViewColumn>
                        </GridView>
                    </ListView.View>
                </ListView>
                <ListView Grid.Column="1" ItemsSource="{Binding Path=SelectedItem.Subjects, ElementName=ErrorViewModelList}">
                    <ListView.Resources>
                        <DataTemplate DataType="{x:Type vm:TestFailure}">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Label>Undtagelsestype:</Label>
                                <Label Grid.Column="1" Content="{Binding Exception}" />

                                <Label Grid.Row="1">Besked:</Label>
                                <Label Grid.Row="1" Grid.Column="1" Content="{Binding Exception.Message}" />

                                <Label Grid.Row="2">Data:</Label>
                                <Label Grid.Row="2" Grid.Column="1" Content="{Binding Post.Data}" />
                            </Grid>
                        </DataTemplate>
                        <DataTemplate DataType="{x:Type vm:XmlValidationErrorViewModel}">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Label>Element:</Label>
                                <Label Grid.Column="1" Content="{Binding Element}" />

                                <Label Grid.Row="1">Besked:</Label>
                                <Label Grid.Row="1" Grid.Column="1" Content="{Binding Message}" />
                            </Grid>
                        </DataTemplate>
                        <DataTemplate DataType="{x:Type vm:TableRowCountViewModel}">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Label>Tabel:</Label>
                                <Button Grid.Column="1" Margin="0,0,0,2" VerticalAlignment="Center" Style="{StaticResource HyperlinkButtonStyle}" cal:Message.Attach="[Event Click] = [Action GoToTable($dataContext)]">
                                    <TextBlock Margin="0,0,0,-2" Text="{Binding Table.Name}" />
                                </Button>

                                <Label Grid.Row="1">Antal:</Label>
                                <Label Grid.Row="1" Grid.Column="1" Content="{Binding Count}" />

                                <Label Grid.Row="2">Rækker:</Label>
                                <Label Grid.Row="2" Grid.Column="1" Content="{Binding Table.Rows}" />
                            </Grid>
                        </DataTemplate>
                        <DataTemplate DataType="{x:Type av:ColumnParsingException}">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Label>Tabel:</Label>
                                <Button Grid.Column="1" Margin="0,0,0,2" VerticalAlignment="Center" Style="{StaticResource HyperlinkButtonStyle}" cal:Message.Attach="[Event Click] = [Action GoToTable($dataContext)]">
                                    <TextBlock Margin="0,0,0,-2" Text="{Binding Table.Name}" />
                                </Button>

                                <Label Grid.Row="1">Element:</Label>
                                <Label Grid.Row="1" Grid.Column="1" Content="{Binding Element}" />
                            </Grid>
                        </DataTemplate>
                        <DataTemplate DataType="{x:Type av:ColumnTypeParsingException}">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Label>Tabel:</Label>
                                <Button Grid.Column="1" Margin="0,0,0,2" VerticalAlignment="Center" Style="{StaticResource HyperlinkButtonStyle}" cal:Message.Attach="[Event Click] = [Action GoToUndefinedColumn($dataContext)]">
                                    <TextBlock Margin="0,0,0,-2">
                                        <TextBlock.Text>
                                            <MultiBinding StringFormat="{}{0}.{1} &lt;{2}&gt;">
                                                <Binding Path="Table.Name"></Binding>
                                                <Binding Path="Name"></Binding>
                                                <Binding Path="Id"></Binding>
                                            </MultiBinding>
                                        </TextBlock.Text>
                                    </TextBlock>
                                </Button>

                                <Label Grid.Row="1">Type:</Label>
                                <Label Grid.Row="1" Grid.Column="1" Content="{Binding Type}" />
                            </Grid>
                        </DataTemplate>
                        <DataTemplate DataType="{x:Type vm:ColumnCount}">
                            <Grid Margin="5">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition/>
                                    <RowDefinition/>
                                </Grid.RowDefinitions>
                                <Label>Tabel:</Label>
                                <Button Grid.Column="1" Margin="0,0,0,2" VerticalAlignment="Center" Style="{StaticResource HyperlinkButtonStyle}" cal:Message.Attach="[Event Click] = [Action GoToColumn($dataContext)]">
                                    <TextBlock Margin="0,0,0,-2">
                                        <TextBlock.Text>
                                            <MultiBinding StringFormat="{}{0}.{1} &lt;{2}&gt;">
                                                <Binding Path="Column.Table.Name"></Binding>
                                                <Binding Path="Column.Name"></Binding>
                                                <Binding Path="Column.ColumnId"></Binding>
                                            </MultiBinding>
                                        </TextBlock.Text>
                                    </TextBlock>
                                </Button>

                                <Label Grid.Row="1">Antal:</Label>
                                <Label Grid.Row="1" Grid.Column="1" Content="{Binding Count}" />
                            </Grid>
                        </DataTemplate>
                    </ListView.Resources>
                </ListView>
            </Grid>
        </TabItem>

        <TabItem Header="Statistik">
            <ScrollViewer>
                <ItemsControl ItemsSource="{Binding DataTypeStatistics}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <GroupBox Margin="5">
                                <GroupBox.Header>
                                    <TextBlock FontWeight="Bold" Text="{Binding DataType}" />
                                </GroupBox.Header>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <Label>Antal kolonner:</Label>
                                    <Label x:Name="MinParamLabel" Grid.Row="1">Minimumsparametre:</Label>
                                    <Label x:Name="MaxParamLabel" Grid.Row="2">Maksimumsparametre:</Label>
                                    <Label Grid.Column="1" Content="{Binding Count}"/>
                                    <Label Grid.Column="1" Grid.Row="1" Content="{Binding MinParam, Converter={StaticResource ParameterToStringConverter}}"/>
                                    <Label Grid.Column="1" Grid.Row="2" Content="{Binding MaxParam, Converter={StaticResource ParameterToStringConverter}}"/>
                                    <Label x:Name="HistLabel" Grid.Row="3" Grid.ColumnSpan="2">Typeparameterhistogrammer:</Label>
                                    <ItemsControl Grid.Row="4" Grid.ColumnSpan="2" ItemsSource="{Binding BarCharts}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel Orientation="Vertical"></StackPanel>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Height="250">
                                                    <oxy:Plot Title="{Binding Title}">
                                                        <oxy:Plot.Series>
                                                            <oxy:ColumnSeries ItemsSource="{Binding Values, Converter={StaticResource ValuesToColumnItemsConverter}}" />
                                                        </oxy:Plot.Series>
                                                        <oxy:Plot.Axes>
                                                            <oxy:CategoryAxis MinimumRange="25" ItemsSource="{Binding Values, Converter={StaticResource ValuesToCategoryAxisConverter}}" />
                                                        </oxy:Plot.Axes>
                                                    </oxy:Plot>
                                                </Grid>
                                                <!--<StackPanel>
                                <TextBlock Text="{Binding Title}" HorizontalAlignment="Center" FontWeight="Bold" />
                                <ctl:BarChart Height="150" Margin="5" BucketCount="{Binding BucketCount}" Values="{Binding Values}"></ctl:BarChart>
                            </StackPanel>-->
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </Grid>
                            </GroupBox>
                            <DataTemplate.Triggers>
                                <DataTrigger Binding="{Binding MinParam}" Value="{x:Null}">
                                    <Setter TargetName="MinParamLabel" Property="Visibility" Value="Collapsed" />
                                    <Setter TargetName="MaxParamLabel" Property="Visibility" Value="Collapsed" />
                                    <Setter TargetName="HistLabel" Property="Visibility" Value="Collapsed" />
                                </DataTrigger>
                            </DataTemplate.Triggers>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Vertical" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </ScrollViewer>
        </TabItem>

        <TabItem Header="Tabeltjek">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition />
                    <ColumnDefinition />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>

                <GroupBox Header="Specificerede tabeller" Padding="5">
                    <TextBox ScrollViewer.CanContentScroll="True" ScrollViewer.VerticalScrollBarVisibility="Auto" AcceptsReturn="True" Text="{Binding SpecTables, Mode=OneWayToSource, UpdateSourceTrigger=PropertyChanged}" />
                </GroupBox>
                <GroupBox Padding="5" Margin="5 0 0 0" Grid.Column="1">
                    <GroupBox.Header>
                        <TextBlock Text="Findes i specifikation og tabelindex" Foreground="Green" />
                    </GroupBox.Header>
                    <TextBox ScrollViewer.CanContentScroll="True" ScrollViewer.VerticalScrollBarVisibility="Auto" Text="{Binding SpecTablesMatching}" IsReadOnly="True" />
                </GroupBox>
                <GroupBox Padding="5" Margin="5 0 0 0"  Grid.Column="2">
                    <GroupBox.Header>
                        <TextBlock Text="Findes i specifikation, men ikke tabelindex" Foreground="Red" />
                    </GroupBox.Header>
                    <TextBox ScrollViewer.CanContentScroll="True" ScrollViewer.VerticalScrollBarVisibility="Auto" Text="{Binding SpecTablesMissing}" IsReadOnly="True" />
                </GroupBox>
                <GroupBox Padding="5" Margin="5 0 0 0"  Grid.Column="3">
                    <GroupBox.Header>
                        <TextBlock Text="Findes ikke i specifikation, men i tabelindex" Foreground="Red" />
                    </GroupBox.Header>
                    <TextBox ScrollViewer.CanContentScroll="True" ScrollViewer.VerticalScrollBarVisibility="Auto" Text="{Binding SpecTablesUndefined}" IsReadOnly="True" />
                </GroupBox>
            </Grid>
        </TabItem>

        <TabItem Header="Nøgletest">
            <DockPanel>
                <DockPanel DockPanel.Dock="Left" Width="250">
                    <Button Height="20" DockPanel.Dock="Bottom" cal:Message.Attach="StopKeyTest">Stop nøgletest</Button>
                    <Button Height="20" DockPanel.Dock="Bottom" cal:Message.Attach="StartKeyTest(KeyTestTableList.SelectedItems)">Start nøgletest</Button>
                    
                    <Grid DockPanel.Dock="Bottom">
                        <ProgressBar Height="20" DockPanel.Dock="Bottom" Value="{Binding KeyTestTotalProgress, Mode=OneWay}"></ProgressBar>
                        <Canvas VerticalAlignment="Center" Height="16">
                            <TextBlock FontWeight="Bold" Width="250" TextAlignment="Center" Canvas.Top="0" Canvas.Left="0" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="KeyTestTotalDoneRows" />
                                        <Binding Path="KeyTestTotalRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="250" TextAlignment="Center" Canvas.Top="2" Canvas.Left="0" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="KeyTestTotalDoneRows" />
                                        <Binding Path="KeyTestTotalRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="250" TextAlignment="Center" Canvas.Top="2" Canvas.Left="2" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="KeyTestTotalDoneRows" />
                                        <Binding Path="KeyTestTotalRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="250" TextAlignment="Center" Canvas.Top="0" Canvas.Left="2" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="KeyTestTotalDoneRows" />
                                        <Binding Path="KeyTestTotalRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="250" TextAlignment="Center" Canvas.Top="1" Canvas.Left="1" Foreground="White">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="KeyTestTotalDoneRows" />
                                        <Binding Path="KeyTestTotalRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                        </Canvas>
                    </Grid>

                    <Grid DockPanel.Dock="Bottom">
                        <ProgressBar Height="20" DockPanel.Dock="Bottom" Value="{Binding KeyTestTableProgress, Mode=OneWay}"></ProgressBar>
                        <Canvas VerticalAlignment="Center" Height="16">
                            <TextBlock FontWeight="Bold" Width="250" TextAlignment="Center" Canvas.Top="0" Canvas.Left="0" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="KeyTestTableDoneRows" />
                                        <Binding Path="KeyTestTableRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="250" TextAlignment="Center" Canvas.Top="2" Canvas.Left="0" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="KeyTestTableDoneRows" />
                                        <Binding Path="KeyTestTableRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="250" TextAlignment="Center" Canvas.Top="2" Canvas.Left="2" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="KeyTestTableDoneRows" />
                                        <Binding Path="KeyTestTableRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="250" TextAlignment="Center" Canvas.Top="0" Canvas.Left="2" Foreground="Black">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="KeyTestTableDoneRows" />
                                        <Binding Path="KeyTestTableRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                            <TextBlock FontWeight="Bold" Width="250" TextAlignment="Center" Canvas.Top="1" Canvas.Left="1" Foreground="White">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0:N0}/{1:N0}">
                                        <Binding Path="KeyTestTableDoneRows" />
                                        <Binding Path="KeyTestTableRowCount" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                        </Canvas>
                    </Grid>

                    <ListBox x:Name="KeyTestTableList" ItemsSource="{Binding KeyTestTablesView}" SelectionMode="Extended" ItemContainerStyle="{StaticResource KeyTestTableListContainerStyle}" />
                </DockPanel>

                <DataGrid DockPanel.Dock="Right" Width="400" ItemsSource="{Binding SelectedItem, ElementName=KeyTestResultList, Converter={StaticResource KeyTestResultListToDataTable}}" />

                <ListView x:Name="KeyTestResultList" ItemsSource="{Binding ForeignKeyTestResults}">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn DisplayMemberBinding="{Binding Item1.Name}" Header="Fremmednøgle"></GridViewColumn>
                            <GridViewColumn DisplayMemberBinding="{Binding Item1.Table.Name}" Header="Tabel"></GridViewColumn>
                            <GridViewColumn DisplayMemberBinding="{Binding Item1.Columns}" Header="Felter"></GridViewColumn>
                            <GridViewColumn DisplayMemberBinding="{Binding Item1.ReferencedTable.Name}" Header="Refereret tabel"></GridViewColumn>
                            <GridViewColumn DisplayMemberBinding="{Binding Item1.ReferencedColumns}" Header="Refererede felter"></GridViewColumn>
                            <GridViewColumn DisplayMemberBinding="{Binding Item2}" Header="Fejl"></GridViewColumn>
                            <GridViewColumn DisplayMemberBinding="{Binding Item3}" Header="Fejltyper"></GridViewColumn>
                        </GridView>
                    </ListView.View>
                </ListView>
            </DockPanel>
        </TabItem>

        <TabItem Header="Sammenlign arkiveringsversion">
            <DockPanel>
                <GroupBox Padding="5" DockPanel.Dock="Top">
                    <GroupBox.Header>
                        <TextBlock>Vælg tabelindex  til sammenligning</TextBlock>
                    </GroupBox.Header>
                    <StackPanel>
                        <DockPanel>
                            <Button Margin="5 0 0 0" DockPanel.Dock="Right" Width="30" cal:Message.Attach="SelectTableIndex()">...</Button>
                            <TextBox DockPanel.Dock="Left" x:Name="CompareLocationTextBox" Text="{Binding CompareLocation, Mode=TwoWay}"></TextBox>
                        </DockPanel>

                        <Button Margin="0 5 0 0" MinWidth="120" cal:Message.Attach="Compare(CompareLocationTextBox)">Sammenlign</Button>
                    </StackPanel>
                </GroupBox>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition />
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition/>
                        <RowDefinition/>
                        <RowDefinition/>
                    </Grid.RowDefinitions>
                    <GroupBox Header="Tabeller" Padding="5" Grid.RowSpan="3">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <ListView x:Name="ComparedTableList" ItemsSource="{Binding TableComparisons}" ItemTemplate="{StaticResource ComparedTableItemTemplate}" >
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="Navn" CellTemplate="{StaticResource ComparedTableItemTemplate}" />
                                        <GridViewColumn Header="Beskrivelse">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsHitTestVisible="False" Focusable="False" IsChecked="{Binding DescriptionModified}" />
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn Header="Rækkeantal">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsHitTestVisible="False" Focusable="False" IsChecked="{Binding RowsModified}" />
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn Header="Mappe">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsHitTestVisible="False" Focusable="False" IsChecked="{Binding FolderModified}" />
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn Header="Felter">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsHitTestVisible="False" Focusable="False" IsChecked="{Binding ColumnsModified}" />
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                            <StackPanel Grid.Row="1" Orientation="Horizontal">
                                <Label>Sammenflet tabeller:</Label>
                                <ComboBox Width="120" x:Name="AddedCombo" ItemsSource="{Binding AddedTableComparisons}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding NewTable.Name}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                                <ComboBox Width="120" x:Name="RemovedCombo" ItemsSource="{Binding RemovedTableComparisons}" >
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding OldTable.Name}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                                <Button cal:Message.Attach="Merge(AddedCombo, RemovedCombo)">Sammenflet</Button>
                            </StackPanel>
                        </Grid>
                    </GroupBox>

                    <GroupBox Header="Valgt tabel" Grid.Column="1" Grid.RowSpan="3" Padding="5" Margin="5 0 0 0">
                        <DockPanel>
                            <DockPanel.Style>
                                <Style>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding SelectedItem, ElementName=ComparedTableList}" Value="{x:Null}">
                                            <Setter Property="DockPanel.Visibility" Value="Collapsed" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DockPanel.Style>
                            <Grid DockPanel.Dock="Top">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                    <RowDefinition />
                                    <RowDefinition />
                                    <RowDefinition />
                                    <RowDefinition />
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <TextBlock Margin="0 0 5 5">Navn:</TextBlock>
                                <TextBlock Margin="0 0 0 5" Grid.Column="1" Text="{Binding SelectedItem.Name, ElementName=ComparedTableList}" />
                                <TextBlock Margin="0 0 5 0" Grid.Row="1">
                                    <TextBlock.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedItem.DescriptionModified, ElementName=ComparedTableList}" Value="True">
                                                    <Setter Property="TextBlock.Foreground" Value="Orange" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                    Beskrivelse:
                                </TextBlock>
                                <TextBox IsReadOnly="True" Grid.Row="1" Grid.Column="1" Text="{Binding SelectedItem.OldTable.Description, ElementName=ComparedTableList, Mode=OneWay}" />
                                <TextBox Margin="0 0 0 5" IsReadOnly="True" Grid.Row="2" Grid.Column="1" Text="{Binding SelectedItem.NewTable.Description, ElementName=ComparedTableList, Mode=OneWay}" />

                                <TextBlock Margin="0 0 5 0" Grid.Row="3">
                                    <TextBlock.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedItem.RowsModified, ElementName=ComparedTableList}" Value="True">
                                                    <Setter Property="TextBlock.Foreground" Value="Orange" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                    Rækkeantal:
                                </TextBlock>
                                <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding SelectedItem.OldTable.Rows, ElementName=ComparedTableList, Mode=OneWay}" />
                                <TextBlock Margin="0 0 0 5" Grid.Row="4" Grid.Column="1" Text="{Binding SelectedItem.NewTable.Rows, ElementName=ComparedTableList, Mode=OneWay}" />

                                <TextBlock Margin="0 0 5 0" Grid.Row="5">
                                    <TextBlock.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedItem.FolderModified, ElementName=ComparedTableList}" Value="True">
                                                    <Setter Property="TextBlock.Foreground" Value="Orange" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                    Mappe:
                                </TextBlock>
                                <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding SelectedItem.OldTable.Folder, ElementName=ComparedTableList, Mode=OneWay}" />
                                <TextBlock Margin="0 0 0 5" Grid.Row="6" Grid.Column="1" Text="{Binding SelectedItem.NewTable.Folder, ElementName=ComparedTableList, Mode=OneWay}" />

                                <TextBlock Margin="0 0 5 0" Grid.Row="7">
                                    <TextBlock.Style>
                                        <Style>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding SelectedItem.ColumnsModified, ElementName=ComparedTableList}" Value="True">
                                                    <Setter Property="TextBlock.Foreground" Value="Orange" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                    Felter:
                                </TextBlock>
                            </Grid>
                            <ListView DockPanel.Dock="Bottom" x:Name="ComparedForeignKeysList" ItemsSource="{Binding SelectedItem.ForeignKeys, ElementName=ComparedTableList}">
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="Navn" CellTemplate="{StaticResource ComparedTableItemTemplate}" />
                                        <GridViewColumn Header="Referencer">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsHitTestVisible="False" Focusable="False" IsChecked="{Binding ReferencesModified}" />
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                    </GridView>
                                </ListView.View>
                            </ListView>

                            <ListView DockPanel.Dock="Bottom" x:Name="ComparedColumnList" ItemsSource="{Binding SelectedItem.Columns, ElementName=ComparedTableList}">
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="Navn" CellTemplate="{StaticResource ComparedTableItemTemplate}" />
                                        <GridViewColumn Header="Beskrivelse">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsHitTestVisible="False" Focusable="False" IsChecked="{Binding DescriptionModified}" />
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn Header="Id">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsHitTestVisible="False" Focusable="False" IsChecked="{Binding IdModified}" />
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn Header="Nullable">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsHitTestVisible="False" Focusable="False" IsChecked="{Binding NullableModified}" />
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                        <GridViewColumn Header="Datatype">
                                            <GridViewColumn.CellTemplate>
                                                <DataTemplate>
                                                    <CheckBox IsHitTestVisible="False" Focusable="False" IsChecked="{Binding DataTypeModified}" />
                                                </DataTemplate>
                                            </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                        </DockPanel>
                    </GroupBox>

                    <GroupBox Header="Valgt felt" Grid.Column="2" Padding="5" Margin="5 0 0 0">
                        <Grid>
                            <Grid.Style>
                                <Style>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding SelectedItem, ElementName=ComparedColumnList}" Value="{x:Null}">
                                            <Setter Property="Grid.Visibility" Value="Collapsed" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Grid.Style>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>

                            <!-- Navn -->
                            <TextBlock Margin="0 0 5 5">Navn:</TextBlock>
                            <TextBlock Margin="0 0 0 5" Grid.Column="1" Text="{Binding SelectedItem.Name, ElementName=ComparedColumnList}" />

                            <!-- Beskrivelse -->
                            <TextBlock  Margin="0 0 5 0" Grid.Row="1">
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SelectedItem.DescriptionModified, ElementName=ComparedColumnList}" Value="True">
                                                <Setter Property="TextBlock.Foreground" Value="Orange" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                                Beskrivelse:
                            </TextBlock>
                            <TextBox IsReadOnly="True" Grid.Row="1" Grid.Column="1" Text="{Binding SelectedItem.OldColumn.Description, ElementName=ComparedColumnList, Mode=OneWay}" />
                            <TextBox Margin="0 0 0 5" IsReadOnly="True" Grid.Row="2" Grid.Column="1" Text="{Binding SelectedItem.NewColumn.Description, ElementName=ComparedColumnList, Mode=OneWay}" />

                            <!-- Id -->
                            <TextBlock Margin="0 0 5 0" Grid.Row="3">
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SelectedItem.IdModified, ElementName=ComparedColumnList}" Value="True">
                                                <Setter Property="TextBlock.Foreground" Value="Orange" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                                Id
                            </TextBlock>
                            <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding SelectedItem.OldColumn.ColumnId, ElementName=ComparedColumnList, Mode=OneWay}" />
                            <TextBlock Margin="0 0 0 5" Grid.Row="4" Grid.Column="1" Text="{Binding SelectedItem.NewColumn.ColumnId, ElementName=ComparedColumnList, Mode=OneWay}" />

                            <!-- Nullable -->
                            <TextBlock Margin="0 0 5 0" Grid.Row="5">
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SelectedItem.NullableModified, ElementName=ComparedColumnList}" Value="True">
                                                <Setter Property="TextBlock.Foreground" Value="Orange" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                                Nullable
                            </TextBlock>
                            <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding SelectedItem.OldColumn.Nullable, ElementName=ComparedColumnList, Mode=OneWay}" />
                            <TextBlock Margin="0 0 0 5" Grid.Row="6" Grid.Column="1" Text="{Binding SelectedItem.NewColumn.Nullable, ElementName=ComparedColumnList, Mode=OneWay}" />

                            <!-- DataType -->
                            <TextBlock Margin="0 0 5 0" Grid.Row="7">
                                <TextBlock.Style>
                                    <Style>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding SelectedItem.DataTypeModified, ElementName=ComparedColumnList}" Value="True">
                                                <Setter Property="TextBlock.Foreground" Value="Orange" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                                Datatype:
                            </TextBlock>
                            <TextBlock Grid.Row="7" Grid.Column="1">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="SelectedItem.OldColumn.ParameterizedDataType.DataType" ElementName="ComparedColumnList" Mode="OneWay" />
                                        <Binding Path="SelectedItem.OldColumn.ParameterizedDataType.Parameter" ElementName="ComparedColumnList" Mode="OneWay" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>

                            <TextBlock Grid.Row="8" Grid.Column="1">
                                <TextBlock.Text>
                                    <MultiBinding StringFormat="{}{0} {1}">
                                        <Binding Path="SelectedItem.NewColumn.ParameterizedDataType.DataType" ElementName="ComparedColumnList" Mode="OneWay" />
                                        <Binding Path="SelectedItem.NewColumn.ParameterizedDataType.Parameter" ElementName="ComparedColumnList" Mode="OneWay" />
                                    </MultiBinding>
                                </TextBlock.Text>
                            </TextBlock>
                        </Grid>
                    </GroupBox>

                    <GroupBox Grid.Row="1" Grid.Column="2" Margin="5" Header="Valgt fremmednøgle">
                        <Grid>
                            <Grid.Style>
                                <Style>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding SelectedItem, ElementName=ComparedForeignKeysList}" Value="{x:Null}">
                                            <Setter Property="Grid.Visibility" Value="Collapsed" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Grid.Style>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Name -->
                            <TextBlock>
                                Navn:
                            </TextBlock>

                            <TextBlock Grid.Column="1" Text="{Binding SelectedItem.Name, ElementName=ComparedForeignKeysList}" />

                            <TextBlock Grid.Row="1">Referencer:</TextBlock>
                            <ListView Grid.Row="2" Grid.ColumnSpan="2" ItemsSource="{Binding SelectedItem.References, ElementName=ComparedForeignKeysList}" >
                                <ListView.View>
                                    <GridView>
                                        <GridViewColumn Header="Kolonne" DisplayMemberBinding="{Binding ColumnName}"></GridViewColumn>
                                        <GridViewColumn Header="Refereret kolonne">
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox IsHitTestVisible="False" Focusable="False" IsChecked="{Binding ReferencedColumn}" />
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                        </GridViewColumn>
                                    </GridView>
                                </ListView.View>
                            </ListView>
                        </Grid>
                    </GroupBox>

                    <GroupBox Grid.Column="2" Grid.Row="2" Margin="5" Header="Valgt reference">
                        <Grid>
                            <Grid.RowDefinitions></Grid.RowDefinitions>
                        </Grid>
                    </GroupBox>
                </Grid>
            </DockPanel>
        </TabItem>

        <TabItem Header="Erstat data">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="2*" />
                </Grid.RowDefinitions>

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>

                <Label>Tabel</Label>
                <ComboBox
                    Grid.Column="1"
                    x:Name="ReplacementTableComboBox"
                    ItemsSource="{Binding ReplaceTablesView, Mode=OneWay}">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Table}" />
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>

                <Label Grid.Row="1">Kolonne</Label>
                <ComboBox
                    Grid.Column="1"
                    Grid.Row="1"
                    x:Name="ReplacementColumnComboBox"
                    ItemsSource="{Binding Path=SelectedItem.ColumnViewModels, ElementName=ReplacementTableComboBox}">
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Column}" />
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>

                <Label Grid.Row="2">Matchudtryk</Label>
                <TextBox
                    Grid.Column="1"
                    Grid.Row="2"
                    x:Name="ReplacementOperationPattern" />

                <Label Grid.Row="3">Erstatningsudtryk</Label>
                <TextBox
                    Grid.Column="1"
                    Grid.Row="3"
                    x:Name="ReplacementOperationReplacement" />
                
                <StackPanel
                    Grid.ColumnSpan="2"
                    Grid.Row="4"
                    Orientation="Horizontal">
                    <Button cal:Message.Attach="AddReplacementOperation(ReplacementTableComboBox, ReplacementColumnComboBox, ReplacementOperationPattern, ReplacementOperationReplacement)">Tilføj operation</Button>
                    <Button cal:Message.Attach="RemoveReplacementOperation(ReplacementOperationListBox)">Fjern valgte operation</Button>
                </StackPanel>

                <ListView
                    Grid.ColumnSpan="2"
                    Grid.Row="5"
                    x:Name="ReplacementOperationListBox"
                    ItemsSource="{Binding ReplacementOperationsView}">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Kolonne" DisplayMemberBinding="{Binding Column.Name}" />
                            <GridViewColumn Header="Matchudtryk" DisplayMemberBinding="{Binding Pattern}" />
                            <GridViewColumn Header="Erstatningsudtryk" DisplayMemberBinding="{Binding Replacement}" />
                        </GridView>
                    </ListView.View>
                    <ListView.GroupStyle>
                        <GroupStyle>
                            <GroupStyle.HeaderTemplate>
                                <DataTemplate>
                                    <TextBlock FontWeight="Bold" Text="{Binding Name}" />
                                </DataTemplate>
                            </GroupStyle.HeaderTemplate>
                        </GroupStyle>
                    </ListView.GroupStyle>
                </ListView>

                <DockPanel
                    Grid.ColumnSpan="2"
                    Grid.Row="6">
                    <Button DockPanel.Dock="Left" cal:Message.Attach="ShowReplaceTable(ReplacementTableComboBox)">Vis erstatning</Button>
                    <Button DockPanel.Dock="Right" cal:Message.Attach="ReplaceTableToFile(ReplacementTableComboBox)">Erstat til fil</Button>
                    <Grid>
                        <ProgressBar Value="{Binding TableReplacementProgressValue}" />
                        <Label Content="{Binding TableReplacementTotalReplacements}" Foreground="Wheat" />
                    </Grid>
                </DockPanel>

                <DataGrid
                    Grid.ColumnSpan="2"
                    Grid.Row="7"
                    ItemsSource="{Binding ReplacedDataTable}"
                    CellStyle="{StaticResource DataGridCellStyle}"
                    IsReadOnly="True"
                    SelectionUnit="Cell" />
            </Grid>
        </TabItem>

        <TabItem Header="Status Log">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <ListView ItemsSource="{Binding LogItems}" Grid.Row="0">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Tidspunkt" DisplayMemberBinding="{Binding Item2, StringFormat={}{0:HH:MM:ss}}" />
                            <GridViewColumn Width="800" Header="Status" CellTemplate="{StaticResource LogListStatusCellTemplate}" />
                        </GridView>
                    </ListView.View>
                </ListView>
                <StackPanel Margin="5" Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Width="50" cal:Message.Attach="SaveLog()">Gem log</Button>
                    <Button Width="50" Margin="5 0 0 0" cal:Message.Attach="ClearLog()">Slet log</Button>
                </StackPanel>
            </Grid>

        </TabItem>
    </TabControl>
</UserControl>
