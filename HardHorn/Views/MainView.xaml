<Window x:Class="HardHorn.Views.MainView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:HardHorn"
        xmlns:cal="http://www.caliburnproject.org"
        mc:Ignorable="d"
        Title="HardHorn" Height="720" Width="1280"
        Background="{StaticResource {x:Static SystemColors.ControlLightBrushKey}}">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition Height="Auto"></RowDefinition>
            <RowDefinition Height="*"></RowDefinition>
            <RowDefinition Height="Auto"></RowDefinition>
        </Grid.RowDefinitions>
        
        <!-- Row 0 -->
        <Label FontWeight="Bold">Vælg arkiveringsversion</Label>

        <!-- Row 1 -->
        <DockPanel Grid.Row="1">
            <Button DockPanel.Dock="Right" Margin="0 0 5 0" Width="50" cal:Message.Attach="LoadTables()">Indlæs</Button>
            <Button DockPanel.Dock="Right" Width="50" cal:Message.Attach="SelectLocation(LocationTextBox)">...</Button>
            <TextBox DockPanel.Dock="Left" Margin="5 0 0 0" x:Name="LocationTextBox" Grid.Row="1" Text="{Binding TestLocation}"></TextBox>
        </DockPanel>

        <!-- Row 2-->
        <Label Grid.Row="2" FontWeight="Bold">Vælg tests</Label>
        
        <!-- Row 3 -->
        <ItemsControl Grid.Row="3" Margin="5 0 5 5" ItemsSource="{Binding TestSuite}" ItemTemplate="{StaticResource TestSuiteCategoryItemTemplate}">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <UniformGrid Rows="1" HorizontalAlignment="Left" />
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
        </ItemsControl>

        <!-- Row 4 -->
        <TabControl Grid.Row="4">
            <TabItem Header="Interaktiv visning">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition MinWidth="250" Width="Auto" />
                        <ColumnDefinition Width="5" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <ListBox Grid.RowSpan="2" DockPanel.Dock="Left" ItemsSource="{Binding Tables}" SelectedItem="{Binding CurrentTable, Mode=OneWayToSource}" ItemContainerStyle="{StaticResource TableListContainerStyle}"></ListBox>
                    <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch"></GridSplitter>
                    <TreeView x:Name="ReportTreeView" Grid.Column="2" DockPanel.Dock="Right" ItemsSource="{Binding TableReports, Mode=OneWay}" ItemContainerStyle="{StaticResource ReportTreeContainerStyle}"></TreeView>
                    <WrapPanel Grid.Row="1" Grid.Column="2" Margin="5">
                        <CheckBox IsChecked="{Binding ShowErrorReports}" Margin="0 0 10 0">Vis fejl</CheckBox>
                        <CheckBox IsChecked="{Binding ShowSuggestionReports}" Margin="0 0 10 0">Vis forslag</CheckBox>
                        <CheckBox IsChecked="{Binding ShowEmptyReports}" Margin="0 0 10 0">Vis resten</CheckBox>
                    </WrapPanel>
                </Grid>
            </TabItem>
            
            <TabItem Header="Statistik">
                <ScrollViewer>
                    <ItemsControl ItemsSource="{Binding DataTypeStatistics}" ItemTemplate="{StaticResource StatisticsItemTemplate}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                    </ItemsControl>
                </ScrollViewer>
            </TabItem>
            
            <TabItem Header="Status Log">
                <ListView ItemsSource="{Binding LogItems}">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="Tidspunkt" DisplayMemberBinding="{Binding Item2, StringFormat={}{0:HH:MM:ss}}" />
                            <GridViewColumn Width="800" Header="Status" CellTemplate="{StaticResource LogListStatusCellTemplate}" />
                        </GridView>
                    </ListView.View>
                </ListView>
            </TabItem>
        </TabControl>

        <!-- Row 5 -->
        <DockPanel Grid.Row="5">
            <Button Width="50" DockPanel.Dock="Right" cal:Message.Attach="SaveLog()">Gem log</Button>
            <Button Width="50" DockPanel.Dock="Right" cal:Message.Attach="ClearLog()">Slet log</Button>
            <Button Width="50" DockPanel.Dock="Right" HorizontalAlignment="Stretch" IsEnabled="{Binding TestLoaded}" cal:Message.Attach="ToggleTest()">
                <Button.Style>
                    <Style TargetType="Button">
                        <Setter Property="Content" Value="Start" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding TestRunning}" Value="True">
                                <Setter Property="Content" Value="Stop"></Setter>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
            </Button>
            <ProgressBar DockPanel.Dock="Left" Value="{Binding TestProgress}" />
        </DockPanel>
    </Grid>
</Window>
